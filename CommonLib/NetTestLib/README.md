# 网络检测工具库
#### 目录介绍
- 01.基础概念介绍
- 02.常见思路和做法
- 03.Api调用说明
- 04.遇到的坑分析
- 05.其他问题说明



### 01.基础概念说明
#### 1.1 如何做网络检测
- 思考一下如何网络检测
    - 1、使用Linux系统ping ip的命令方式检查设备的Internet连接状态。
    - 2、使用HttpURLConnection的get请求方式检查设备的Internet连接状态。（可以设置超时时长）
    - 3、使用java.net.InetAddress解析域名的方式检查设备的Internet连接状态。（可以设置超时时长）
    - 4、使用WebView去加载百度网页，如果能加载出来，则表示Internet是连接状态。
    - 5、使用okHttp网络库去请求项目中所用到的接口，如果能请求成功，则表示网络可用状态。
- 测试网络连接状态使用
    - 用到了三种常用的Internet状态检查方式，如果想在做某些网络操作之前检查Internet是否连通，建议使用后两种方式，可以自己定义等待响应的时间。
    - 这边设置的是3秒。如果使用ping IP的方式的话，如果无法访问到Internet，则需要等待较长的时间。




#### 1.2 区分一些概念
- 打开网络和可用网络
    - 用户手机当前网络可用：WIFI、2G/3G网络，用户打开与不打开网络，和是否可以用是两码事。可以使用指的是：用户打开网络了并且可以连上互联网进行上网。
- 判断网络能进行上网的标准
    - 访问百度网页，如果能访问成功，则表明网络连接并且可以上网呢。
- 仅仅靠：isAvailable判断可用不够的
    - 举一个例子：连接上A网络Wi-Fi，该网络连接上并且可用，但是需要身份验证(验证码)，这个时候可用，但是却不可上网。
    - 举一个例子：移动流量打开了，信号显示4G，但是一会儿流量欠费了，无法上网。但是类似大王卡却可以走一部分腾讯视频的免费流量。



#### 1.3 为何做网络检测
- 有时候当手机显示网络连接成功时，并不一定表示可以真的上网
    - 比如肯德基或者一些酒店的无线网络时常需要登录验证才能使用；
    - 比如刚启动路由器时虽然手机上会显示连接到路由器但实际上路由器还未初始化完成所以未能上网；
    - 甚至是网络欠费了而你依然能够连接到路由器，都会出现上面的情况。





### 02.常见思路和做法
#### 2.1 ping工具判断网络
- 可以通过 ping 命令来判断网络是否联通
    - PING 全称为 Packet Internet Groper，即因特网包探索器，可以将它作为网络诊断工具。
    - ping 命令在 Windows、macOS 和 Linux 下都是可以直接使用的，那 Android 当然也不例外
- 使用 ping 命令可以获得不同网络状态下的结果，如下：
    - 连通的移动数据网络下：0
    - 需要网页认证的 Wi-Fi 下：1
    - Wi-Fi 打开但没有网络连接，数据也不可用的状态下：2
    - 在不可用的 Wi-Fi 下：2
    - 在可用的 Wi-Fi 下：0
- 所以只要判断结果为 0 即表示网络已连通。
    - 但该方法有个致命的缺点，当网络未连通时，它可以马上返回 false，但是当网络连通时，它需要耗费约 10 秒的时间才能返回结果。


#### 2.2 网络联网判断思路
- App判断用户是否联网是很普遍的需求，实现思路大概有下面几种
    - 第一步：利用Android自带的ConnectivityManager类
    - 第二步：有时候连上了wifi，但这个wifi是上不了网的，我们可以通过ping www.baidu.com来判断是否可以上网
    - 第三步：也可以利用get请求访问www.baidu.com，如果get请求成功，说明可以上网




### 03.Api调用说明



### 04.遇到的坑分析
#### 4.1 ping网络分析
- 注意：ping网址是最最常用的一种判断网络的方式，也是通用方法。
    - 这种方法最大的劣势是，耗时很长，我曾计算过，ping一次的时间大约是10s，两次是11s，每增加一次就多耗时1s。
    - 虽然这种方法耗时较长，但这是目前最常用的方法，而且没有更好的方法取代。



### 05.其他问题说明




